# Unicode æŸ¥æ‰¾è¡¨

**çŠ¶æ€**: âš ï¸ éƒ¨åˆ†å·²çŸ¥
**æœ€åæ›´æ–°**: 2026-01-29

---

## Unicode åˆ° r5 æ˜ å°„æœºåˆ¶

### å·²çŸ¥æ˜ å°„å…³ç³»

| å­—ç¬¦ | Unicode | r5 å€¼ | å·®å€¼ (Unicode - r5) |
|------|---------|-------|---------------------|
| æ²¨ | U+6CA8 | 0x0FDE | -0x5CCA (-23754) |
| æ²¤ | U+6CA4 | 0x0FDB | -0x5CC9 (-23753) |
| æ²¦ | U+6CA6 | 0x0FDC | -0x5CCA (-23754) |
| æ²ª | U+6CAA | 0x0FDA | -0x5CCE (-23758) |

**æ˜ å°„å…¬å¼** (æ¥è‡ªåŸåˆ†æ):
```
r5 = Unicode - 0x5CCA + sub_offset
```

### é«˜å­—èŠ‚æ˜ å°„

| Unicode é«˜å­—èŠ‚ | r5 é«˜å­—èŠ‚ | è®¡ç®— |
|----------------|-----------|------|
| 0x6C | 0x0F | 0x6C - 0x5D = 0x0F |

### ä½å­—èŠ‚åç§»åˆ†æ

| u_lo | offset | åè¿›åˆ¶ | å­—ç¬¦ |
|------|--------|--------|------|
| 0xA4 | 0x37 | 55 | æ²¤ |
| 0xA6 | 0x36 | 54 | æ²¦ |
| 0xA8 | 0x36 | 54 | æ²¨ |
| 0xAA | 0x32 | 50 | æ²ª |

**è§‚å¯Ÿ**:
- åç§»å€¼èŒƒå›´: 50-55 (0x32-0x37)
- ä¸æ˜¯ç®€å•çš„çº¿æ€§å…³ç³»
- å¯èƒ½é€šè¿‡æŸ¥è¡¨æˆ–ä½è¿ç®—å¾—å‡º

### offset() å…¬å¼ç ”ç©¶è¿›å±•

åŸåˆ†æä¸­æµ‹è¯•è¿‡çš„å…¬å¼:

| å…¬å¼ | åŒ¹é…åº¦ | è¯´æ˜ |
|------|--------|------|
| `offset = 0x32 + ((u_lo ^ 0xAA) >> 2)` | 1/4 | ä»…åŒ¹é… 0xAA |
| `offset = 0x32 + ((~idx) & 0x0F) >> 1` | 2/4 | åŒ¹é… 0xA4, 0xA6 |
| `offset = 0x32 + ((u_lo & 0x0F) ^ 0x0A) >> 1` | 1/4 | ä»…åŒ¹é… 0xAA |

**çŠ¶æ€**: â“ æœªæ‰¾åˆ°å®Œå…¨åŒ¹é…çš„å…¬å¼ï¼Œoffset å‡½æ•°çš„å…·ä½“å®ç°æœªçŸ¥

---

## r5 å¯„å­˜å™¨åŠ è½½ä½ç½®

```assembly
0x0002DA8E:  ldm    r1!, {r3, r4, r5, r6, r7}  ; r5 = [r1 + 8]
```

r5 ä»æ¸²æŸ“ä¸Šä¸‹æ–‡åç§» +8 åŠ è½½ã€‚

---

## ç¬¦å·è¡¨è®¡ç®—

```assembly
0x0002DAD4:  movs   r4, r5         ; r4 = r5
0x0002DB74:  lsls   r4, r5, #5     ; r4 = r5 * 32
```

- æ¯ä¸ªå­—ç¬¦çš„ç¬¦å·è¡¨å ç”¨ 32 å­—èŠ‚
- ç¬¦å·è¡¨åœ°å€ = r5 << 5

---

## ç¬¦å·è¡¨ç»“æ„ (æ²¨å­— @ 0x1FBC0)

```
åç§»  å€¼(HEX)  å€¼(DEC)  è¯´æ˜
+00   0xCD     205      åˆ— 0 åŸºå‡†å€¼ (-51)
+01   0xDE     222      åˆ— 1 è°ƒæ•´å€¼ (-34)
+02   0xCD     205      åˆ— 2 åŸºå‡†å€¼ (-51)
+03   0xDF     223      åˆ— 3 è°ƒæ•´å€¼ (-33)
+04   0xCD     205      åˆ— 4 åŸºå‡†å€¼ (-51)
+05   0xE0     224      åˆ— 5 è°ƒæ•´å€¼ (-32)
+06   0xCD     205      åˆ— 6 åŸºå‡†å€¼ (-51)
+07   0xE1     225      åˆ— 7 è°ƒæ•´å€¼ (-31)
+08   0x00       0      åˆ— 8+ (ç©º)

æ¨¡å¼: å¶æ•°ç´¢å¼• = 0xCD (å›ºå®š), å¥‡æ•°ç´¢å¼• = é€’å¢å€¼
```

---

## ç¬¦å·è¡¨åœ°å€ç¤ºä¾‹

| å­—ç¬¦ | r5 å€¼ | ç¬¦å·è¡¨åœ°å€ (r5 Ã— 32) |
|------|-------|---------------------|
| æ²¨ | 0x0FDE | 0x1FBC0 |
| æ²¤ | 0x0FDB | 0x1FB60 |
| æ²¦ | 0x0FDC | 0x1FB80 |
| æ²ª | 0x0FDA | 0x1FB80 |

---

## r5 çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸ

```
1. Unicode è¾“å…¥ â†’ æ˜ å°„å‡½æ•° â†’ r5 = 0x0FDE
2. r5 å­˜å‚¨åˆ°æ¸²æŸ“ä¸Šä¸‹æ–‡ [ctx + 8]
3. æ¸²æŸ“æ—¶ä»ä¸Šä¸‹æ–‡åŠ è½½ r5
4. r5 è®¡ç®—ç¬¦å·è¡¨åœ°å€: r4 = r5 << 5
5. ç¬¦å·è¡¨ç”¨äºåƒç´ æ¸²æŸ“
```

---

## å‰©ä½™é—®é¢˜

Unicode æ˜ å°„ç›¸å…³çš„è¯¦ç»†é—®é¢˜å·²æ±‡æ€»åˆ° **[REMAINING_WORK.md](../../01_OVERVIEW/REMAINING_WORK.md)** é˜¶æ®µ 1ã€‚

| é—®é¢˜ | ä¼˜å…ˆçº§ | çŠ¶æ€ |
|------|--------|------|
| Unicode â†’ r5 æ˜ å°„å‡½æ•°ä½ç½® | ğŸ”´ é«˜ | â“ æœªæ‰¾åˆ° |
| offset() å‡½æ•°å…·ä½“å®ç° | ğŸŸ¡ ä¸­ | â“ éƒ¨åˆ†åŒ¹é… |
| åç§»è¡¨ä½ç½® | ğŸŸ¡ ä¸­ | â“ å›ºä»¶ä¸­æœªæ‰¾åˆ°æ˜æ˜¾çš„è¡¨ |
| å…¶ä»– Unicode èŒƒå›´çš„å¤„ç† | ğŸŸ¢ ä½ | â“ éœ€è¦æ›´å¤šæ ·æœ¬ |

---

**å‚è§**:
- [åƒç´ æ•°æ®ä½ç½®](./PIXEL_DATA_LOCATION.md)
- [ç¼–ç è§„åˆ™](./ENCODING_RULES.md)
- [è°ƒè¯•ç”¨å­—ç¬¦è¡¨](./DEBUG_CHARACTER_TABLE.md)
- [R5 å¯„å­˜å™¨åˆ†æ](../03_CODE_ANALYSIS/REGISTERS/R5_UNICODE_INDEX.md)
